\hypertarget{cmac_8h}{}\section{E\+:/\+React\+O\+S-\/0.4.6/sdk/include/reactos/libs/mbedtls/cmac.h 文件参考}
\label{cmac_8h}\index{E\+:/\+React\+O\+S-\/0.\+4.\+6/sdk/include/reactos/libs/mbedtls/cmac.\+h@{E\+:/\+React\+O\+S-\/0.\+4.\+6/sdk/include/reactos/libs/mbedtls/cmac.\+h}}


Cipher-\/based Message Authentication Code (C\+M\+AC) Mode for Authentication  


{\ttfamily \#include \char`\"{}mbedtls/cipher.\+h\char`\"{}}\newline
\subsection*{类}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structmbedtls__cmac__context__t}{mbedtls\+\_\+cmac\+\_\+context\+\_\+t}
\end{DoxyCompactItemize}
\subsection*{宏定义}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{cmac_8h_a5c776e34150416e27f28a6a03da68f0e}\label{cmac_8h_a5c776e34150416e27f28a6a03da68f0e}} 
\#\hyperlink{structdefine}{define} {\bfseries M\+B\+E\+D\+T\+L\+S\+\_\+\+A\+E\+S\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}~16
\item 
\mbox{\Hypertarget{cmac_8h_aa884d76e1c27c156a788a4763f571c67}\label{cmac_8h_aa884d76e1c27c156a788a4763f571c67}} 
\#\hyperlink{structdefine}{define} {\bfseries M\+B\+E\+D\+T\+L\+S\+\_\+\+D\+E\+S3\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+I\+ZE}~8
\item 
\mbox{\Hypertarget{cmac_8h_accb84fb7db8f619f0fdf8ef1ee7552af}\label{cmac_8h_accb84fb7db8f619f0fdf8ef1ee7552af}} 
\#\hyperlink{structdefine}{define} {\bfseries M\+B\+E\+D\+T\+L\+S\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+B\+L\+K\+S\+I\+Z\+E\+\_\+\+M\+AX}~8   /$\ast$ longest used by C\+M\+AC is 3\+D\+E\+S $\ast$/
\end{DoxyCompactItemize}
\subsection*{函数}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{cmac_8h_ae5835d528bbfec2ae2452ba4617469b8}{mbedtls\+\_\+cipher\+\_\+cmac\+\_\+starts} (\hyperlink{structmbedtls__cipher__context__t}{mbedtls\+\_\+cipher\+\_\+context\+\_\+t} $\ast$ctx, const unsigned char $\ast$\hyperlink{structkey}{key}, size\+\_\+t keybits)
\begin{DoxyCompactList}\small\item\em Set the C\+M\+AC key and prepare to authenticate the input data. Should be called with an initialized cipher context. \end{DoxyCompactList}\item 
int \hyperlink{cmac_8h_a14441964606982e0a664a8bb48bddad6}{mbedtls\+\_\+cipher\+\_\+cmac\+\_\+update} (\hyperlink{structmbedtls__cipher__context__t}{mbedtls\+\_\+cipher\+\_\+context\+\_\+t} $\ast$ctx, const unsigned char $\ast$input, size\+\_\+t ilen)
\begin{DoxyCompactList}\small\item\em Generic C\+M\+AC process buffer. Called between \hyperlink{cmac_8h_ae5835d528bbfec2ae2452ba4617469b8}{mbedtls\+\_\+cipher\+\_\+cmac\+\_\+starts()} or \hyperlink{cmac_8h_a364af1a9ac845cbf21d7a64f1f43c71a}{mbedtls\+\_\+cipher\+\_\+cmac\+\_\+reset()} and \hyperlink{cmac_8h_a9adc5b4b09b40d41bb6554c8ecfa755d}{mbedtls\+\_\+cipher\+\_\+cmac\+\_\+finish()}. May be called repeatedly. \end{DoxyCompactList}\item 
int \hyperlink{cmac_8h_a9adc5b4b09b40d41bb6554c8ecfa755d}{mbedtls\+\_\+cipher\+\_\+cmac\+\_\+finish} (\hyperlink{structmbedtls__cipher__context__t}{mbedtls\+\_\+cipher\+\_\+context\+\_\+t} $\ast$ctx, unsigned char $\ast$output)
\begin{DoxyCompactList}\small\item\em Output C\+M\+AC. Called after \hyperlink{cmac_8h_a14441964606982e0a664a8bb48bddad6}{mbedtls\+\_\+cipher\+\_\+cmac\+\_\+update()}. Usually followed by \hyperlink{cmac_8h_a364af1a9ac845cbf21d7a64f1f43c71a}{mbedtls\+\_\+cipher\+\_\+cmac\+\_\+reset()}, then \hyperlink{cmac_8h_ae5835d528bbfec2ae2452ba4617469b8}{mbedtls\+\_\+cipher\+\_\+cmac\+\_\+starts()}, or \hyperlink{cipher_8h_a903c4146b471207690988584b83854a9}{mbedtls\+\_\+cipher\+\_\+free()}. \end{DoxyCompactList}\item 
int \hyperlink{cmac_8h_a364af1a9ac845cbf21d7a64f1f43c71a}{mbedtls\+\_\+cipher\+\_\+cmac\+\_\+reset} (\hyperlink{structmbedtls__cipher__context__t}{mbedtls\+\_\+cipher\+\_\+context\+\_\+t} $\ast$ctx)
\begin{DoxyCompactList}\small\item\em Prepare to authenticate a new message with the same key. Called after \hyperlink{cmac_8h_a9adc5b4b09b40d41bb6554c8ecfa755d}{mbedtls\+\_\+cipher\+\_\+cmac\+\_\+finish()} and before \hyperlink{cmac_8h_a14441964606982e0a664a8bb48bddad6}{mbedtls\+\_\+cipher\+\_\+cmac\+\_\+update()}. \end{DoxyCompactList}\item 
int \hyperlink{cmac_8h_af44bc935db9b27fbfe485936b5ad99ed}{mbedtls\+\_\+cipher\+\_\+cmac} (const \hyperlink{structmbedtls__cipher__info__t}{mbedtls\+\_\+cipher\+\_\+info\+\_\+t} $\ast$cipher\+\_\+info, const unsigned char $\ast$\hyperlink{structkey}{key}, size\+\_\+t keylen, const unsigned char $\ast$input, size\+\_\+t ilen, unsigned char $\ast$output)
\begin{DoxyCompactList}\small\item\em Output = Generic\+\_\+\+C\+M\+A\+C( cmac key, input buffer ) \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{详细描述}
Cipher-\/based Message Authentication Code (C\+M\+AC) Mode for Authentication 

Copyright (\hyperlink{struct_c}{C}) 2015-\/2016, A\+RM Limited, All Rights Reserved S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0

\hyperlink{namespace_this}{This} program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

\hyperlink{namespace_this}{This} program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR \hyperlink{struct_a}{A} P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301 U\+SA.

\hyperlink{namespace_this}{This} file is part of mbed T\+LS (\href{https://tls.mbed.org}{\tt https\+://tls.\+mbed.\+org}) 

\subsection{函数说明}
\mbox{\Hypertarget{cmac_8h_af44bc935db9b27fbfe485936b5ad99ed}\label{cmac_8h_af44bc935db9b27fbfe485936b5ad99ed}} 
\index{cmac.\+h@{cmac.\+h}!mbedtls\+\_\+cipher\+\_\+cmac@{mbedtls\+\_\+cipher\+\_\+cmac}}
\index{mbedtls\+\_\+cipher\+\_\+cmac@{mbedtls\+\_\+cipher\+\_\+cmac}!cmac.\+h@{cmac.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+cipher\+\_\+cmac()}{mbedtls\_cipher\_cmac()}}
{\footnotesize\ttfamily int mbedtls\+\_\+cipher\+\_\+cmac (\begin{DoxyParamCaption}\item[{const \hyperlink{structmbedtls__cipher__info__t}{mbedtls\+\_\+cipher\+\_\+info\+\_\+t} $\ast$}]{cipher\+\_\+info,  }\item[{const unsigned char $\ast$}]{key,  }\item[{size\+\_\+t}]{keylen,  }\item[{const unsigned char $\ast$}]{input,  }\item[{size\+\_\+t}]{ilen,  }\item[{unsigned char $\ast$}]{output }\end{DoxyParamCaption})}



Output = Generic\+\_\+\+C\+M\+A\+C( cmac key, input buffer ) 


\begin{DoxyParams}{参数}
{\em cipher\+\_\+info} & message digest info \\
\hline
{\em key} & C\+M\+AC key \\
\hline
{\em keylen} & length of the C\+M\+AC key in bits \\
\hline
{\em input} & buffer holding the data \\
\hline
{\em ilen} & length of the input data \\
\hline
{\em output} & Generic C\+M\+A\+C-\/result\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{返回}
0 on success, M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+M\+D\+\_\+\+B\+A\+D\+\_\+\+I\+N\+P\+U\+T\+\_\+\+D\+A\+TA if parameter verification fails. 
\end{DoxyReturn}
\mbox{\Hypertarget{cmac_8h_a9adc5b4b09b40d41bb6554c8ecfa755d}\label{cmac_8h_a9adc5b4b09b40d41bb6554c8ecfa755d}} 
\index{cmac.\+h@{cmac.\+h}!mbedtls\+\_\+cipher\+\_\+cmac\+\_\+finish@{mbedtls\+\_\+cipher\+\_\+cmac\+\_\+finish}}
\index{mbedtls\+\_\+cipher\+\_\+cmac\+\_\+finish@{mbedtls\+\_\+cipher\+\_\+cmac\+\_\+finish}!cmac.\+h@{cmac.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+cipher\+\_\+cmac\+\_\+finish()}{mbedtls\_cipher\_cmac\_finish()}}
{\footnotesize\ttfamily int mbedtls\+\_\+cipher\+\_\+cmac\+\_\+finish (\begin{DoxyParamCaption}\item[{\hyperlink{structmbedtls__cipher__context__t}{mbedtls\+\_\+cipher\+\_\+context\+\_\+t} $\ast$}]{ctx,  }\item[{unsigned char $\ast$}]{output }\end{DoxyParamCaption})}



Output C\+M\+AC. Called after \hyperlink{cmac_8h_a14441964606982e0a664a8bb48bddad6}{mbedtls\+\_\+cipher\+\_\+cmac\+\_\+update()}. Usually followed by \hyperlink{cmac_8h_a364af1a9ac845cbf21d7a64f1f43c71a}{mbedtls\+\_\+cipher\+\_\+cmac\+\_\+reset()}, then \hyperlink{cmac_8h_ae5835d528bbfec2ae2452ba4617469b8}{mbedtls\+\_\+cipher\+\_\+cmac\+\_\+starts()}, or \hyperlink{cipher_8h_a903c4146b471207690988584b83854a9}{mbedtls\+\_\+cipher\+\_\+free()}. 


\begin{DoxyParams}{参数}
{\em ctx} & C\+M\+AC context \\
\hline
{\em output} & Generic C\+M\+AC checksum result\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{返回}
0 on success, M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+M\+D\+\_\+\+B\+A\+D\+\_\+\+I\+N\+P\+U\+T\+\_\+\+D\+A\+TA if parameter verification fails. 
\end{DoxyReturn}
\mbox{\Hypertarget{cmac_8h_a364af1a9ac845cbf21d7a64f1f43c71a}\label{cmac_8h_a364af1a9ac845cbf21d7a64f1f43c71a}} 
\index{cmac.\+h@{cmac.\+h}!mbedtls\+\_\+cipher\+\_\+cmac\+\_\+reset@{mbedtls\+\_\+cipher\+\_\+cmac\+\_\+reset}}
\index{mbedtls\+\_\+cipher\+\_\+cmac\+\_\+reset@{mbedtls\+\_\+cipher\+\_\+cmac\+\_\+reset}!cmac.\+h@{cmac.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+cipher\+\_\+cmac\+\_\+reset()}{mbedtls\_cipher\_cmac\_reset()}}
{\footnotesize\ttfamily int mbedtls\+\_\+cipher\+\_\+cmac\+\_\+reset (\begin{DoxyParamCaption}\item[{\hyperlink{structmbedtls__cipher__context__t}{mbedtls\+\_\+cipher\+\_\+context\+\_\+t} $\ast$}]{ctx }\end{DoxyParamCaption})}



Prepare to authenticate a new message with the same key. Called after \hyperlink{cmac_8h_a9adc5b4b09b40d41bb6554c8ecfa755d}{mbedtls\+\_\+cipher\+\_\+cmac\+\_\+finish()} and before \hyperlink{cmac_8h_a14441964606982e0a664a8bb48bddad6}{mbedtls\+\_\+cipher\+\_\+cmac\+\_\+update()}. 


\begin{DoxyParams}{参数}
{\em ctx} & C\+M\+AC context to be reset\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{返回}
0 on success, M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+M\+D\+\_\+\+B\+A\+D\+\_\+\+I\+N\+P\+U\+T\+\_\+\+D\+A\+TA if parameter verification fails. 
\end{DoxyReturn}
\mbox{\Hypertarget{cmac_8h_ae5835d528bbfec2ae2452ba4617469b8}\label{cmac_8h_ae5835d528bbfec2ae2452ba4617469b8}} 
\index{cmac.\+h@{cmac.\+h}!mbedtls\+\_\+cipher\+\_\+cmac\+\_\+starts@{mbedtls\+\_\+cipher\+\_\+cmac\+\_\+starts}}
\index{mbedtls\+\_\+cipher\+\_\+cmac\+\_\+starts@{mbedtls\+\_\+cipher\+\_\+cmac\+\_\+starts}!cmac.\+h@{cmac.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+cipher\+\_\+cmac\+\_\+starts()}{mbedtls\_cipher\_cmac\_starts()}}
{\footnotesize\ttfamily int mbedtls\+\_\+cipher\+\_\+cmac\+\_\+starts (\begin{DoxyParamCaption}\item[{\hyperlink{structmbedtls__cipher__context__t}{mbedtls\+\_\+cipher\+\_\+context\+\_\+t} $\ast$}]{ctx,  }\item[{const unsigned char $\ast$}]{key,  }\item[{size\+\_\+t}]{keybits }\end{DoxyParamCaption})}



Set the C\+M\+AC key and prepare to authenticate the input data. Should be called with an initialized cipher context. 


\begin{DoxyParams}{参数}
{\em ctx} & Cipher context. \hyperlink{namespace_this}{This} should be a cipher context, initialized to be one of the following types\+: M\+B\+E\+D\+T\+L\+S\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+E\+S\+\_\+128\+\_\+\+E\+CB, M\+B\+E\+D\+T\+L\+S\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+E\+S\+\_\+192\+\_\+\+E\+CB, M\+B\+E\+D\+T\+L\+S\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+A\+E\+S\+\_\+256\+\_\+\+E\+CB or M\+B\+E\+D\+T\+L\+S\+\_\+\+C\+I\+P\+H\+E\+R\+\_\+\+D\+E\+S\+\_\+\+E\+D\+E3\+\_\+\+E\+CB. \\
\hline
{\em key} & C\+M\+AC key \\
\hline
{\em keybits} & length of the C\+M\+AC key in bits (must be acceptable by the cipher)\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{返回}
0 if successful, or a cipher specific error code 
\end{DoxyReturn}
\mbox{\Hypertarget{cmac_8h_a14441964606982e0a664a8bb48bddad6}\label{cmac_8h_a14441964606982e0a664a8bb48bddad6}} 
\index{cmac.\+h@{cmac.\+h}!mbedtls\+\_\+cipher\+\_\+cmac\+\_\+update@{mbedtls\+\_\+cipher\+\_\+cmac\+\_\+update}}
\index{mbedtls\+\_\+cipher\+\_\+cmac\+\_\+update@{mbedtls\+\_\+cipher\+\_\+cmac\+\_\+update}!cmac.\+h@{cmac.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+cipher\+\_\+cmac\+\_\+update()}{mbedtls\_cipher\_cmac\_update()}}
{\footnotesize\ttfamily int mbedtls\+\_\+cipher\+\_\+cmac\+\_\+update (\begin{DoxyParamCaption}\item[{\hyperlink{structmbedtls__cipher__context__t}{mbedtls\+\_\+cipher\+\_\+context\+\_\+t} $\ast$}]{ctx,  }\item[{const unsigned char $\ast$}]{input,  }\item[{size\+\_\+t}]{ilen }\end{DoxyParamCaption})}



Generic C\+M\+AC process buffer. Called between \hyperlink{cmac_8h_ae5835d528bbfec2ae2452ba4617469b8}{mbedtls\+\_\+cipher\+\_\+cmac\+\_\+starts()} or \hyperlink{cmac_8h_a364af1a9ac845cbf21d7a64f1f43c71a}{mbedtls\+\_\+cipher\+\_\+cmac\+\_\+reset()} and \hyperlink{cmac_8h_a9adc5b4b09b40d41bb6554c8ecfa755d}{mbedtls\+\_\+cipher\+\_\+cmac\+\_\+finish()}. May be called repeatedly. 


\begin{DoxyParams}{参数}
{\em ctx} & C\+M\+AC context \\
\hline
{\em input} & buffer holding the data \\
\hline
{\em ilen} & length of the input data\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{返回}
0 on success, M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+M\+D\+\_\+\+B\+A\+D\+\_\+\+I\+N\+P\+U\+T\+\_\+\+D\+A\+TA if parameter verification fails. 
\end{DoxyReturn}
