\hypertarget{ccm_8h}{}\section{E\+:/\+React\+O\+S-\/0.4.6/sdk/include/reactos/libs/mbedtls/ccm.h 文件参考}
\label{ccm_8h}\index{E\+:/\+React\+O\+S-\/0.\+4.\+6/sdk/include/reactos/libs/mbedtls/ccm.\+h@{E\+:/\+React\+O\+S-\/0.\+4.\+6/sdk/include/reactos/libs/mbedtls/ccm.\+h}}


Counter with C\+B\+C-\/\+M\+AC (C\+CM) for 128-\/bit block ciphers  


{\ttfamily \#include \char`\"{}cipher.\+h\char`\"{}}\newline
\subsection*{类}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structmbedtls__ccm__context}{mbedtls\+\_\+ccm\+\_\+context}
\begin{DoxyCompactList}\small\item\em C\+CM context structure \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{宏定义}
\begin{DoxyCompactItemize}
\item 
\#\hyperlink{structdefine}{define} \hyperlink{ccm_8h_a6ad00876b856ad8ac9f366fa7e1cf463}{M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+C\+C\+M\+\_\+\+B\+A\+D\+\_\+\+I\+N\+P\+UT}~-\/0x000D
\item 
\#\hyperlink{structdefine}{define} \hyperlink{ccm_8h_ae7fda1fbbd14f096374da7ccd54f9d3e}{M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+C\+C\+M\+\_\+\+A\+U\+T\+H\+\_\+\+F\+A\+I\+L\+ED}~-\/0x000F
\end{DoxyCompactItemize}
\subsection*{函数}
\begin{DoxyCompactItemize}
\item 
\hyperlink{interfacevoid}{void} \hyperlink{ccm_8h_abaeb0629dfac72016fda58a4f7870040}{mbedtls\+\_\+ccm\+\_\+init} (\hyperlink{structmbedtls__ccm__context}{mbedtls\+\_\+ccm\+\_\+context} $\ast$ctx)
\begin{DoxyCompactList}\small\item\em Initialize C\+CM context (just makes references valid) Makes the context ready for \hyperlink{ccm_8h_a464d8e724738b4bbd5b415ca0580f1b1}{mbedtls\+\_\+ccm\+\_\+setkey()} or \hyperlink{ccm_8h_a2bd8130a83c6633a4dfd61b181cdabac}{mbedtls\+\_\+ccm\+\_\+free()}. \end{DoxyCompactList}\item 
int \hyperlink{ccm_8h_a464d8e724738b4bbd5b415ca0580f1b1}{mbedtls\+\_\+ccm\+\_\+setkey} (\hyperlink{structmbedtls__ccm__context}{mbedtls\+\_\+ccm\+\_\+context} $\ast$ctx, mbedtls\+\_\+cipher\+\_\+id\+\_\+t cipher, const unsigned char $\ast$\hyperlink{structkey}{key}, unsigned int keybits)
\begin{DoxyCompactList}\small\item\em C\+CM initialization (encryption and decryption) \end{DoxyCompactList}\item 
\hyperlink{interfacevoid}{void} \hyperlink{ccm_8h_a2bd8130a83c6633a4dfd61b181cdabac}{mbedtls\+\_\+ccm\+\_\+free} (\hyperlink{structmbedtls__ccm__context}{mbedtls\+\_\+ccm\+\_\+context} $\ast$ctx)
\begin{DoxyCompactList}\small\item\em Free a C\+CM context and underlying cipher sub-\/context \end{DoxyCompactList}\item 
int \hyperlink{ccm_8h_a64de697edfefbff94d7eb0d9a8de926f}{mbedtls\+\_\+ccm\+\_\+encrypt\+\_\+and\+\_\+tag} (\hyperlink{structmbedtls__ccm__context}{mbedtls\+\_\+ccm\+\_\+context} $\ast$ctx, size\+\_\+t length, const unsigned char $\ast$iv, size\+\_\+t iv\+\_\+len, const unsigned char $\ast$add, size\+\_\+t add\+\_\+len, const unsigned char $\ast$input, unsigned char $\ast$output, unsigned char $\ast$\hyperlink{structtag}{tag}, size\+\_\+t tag\+\_\+len)
\begin{DoxyCompactList}\small\item\em C\+CM buffer encryption \end{DoxyCompactList}\item 
int \hyperlink{ccm_8h_a8dc9dfe246064185498f005d8bf22622}{mbedtls\+\_\+ccm\+\_\+auth\+\_\+decrypt} (\hyperlink{structmbedtls__ccm__context}{mbedtls\+\_\+ccm\+\_\+context} $\ast$ctx, size\+\_\+t length, const unsigned char $\ast$iv, size\+\_\+t iv\+\_\+len, const unsigned char $\ast$add, size\+\_\+t add\+\_\+len, const unsigned char $\ast$input, unsigned char $\ast$output, const unsigned char $\ast$\hyperlink{structtag}{tag}, size\+\_\+t tag\+\_\+len)
\begin{DoxyCompactList}\small\item\em C\+CM buffer authenticated decryption \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{详细描述}
Counter with C\+B\+C-\/\+M\+AC (C\+CM) for 128-\/bit block ciphers 

Copyright (\hyperlink{struct_c}{C}) 2006-\/2015, A\+RM Limited, All Rights Reserved S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0

\hyperlink{namespace_this}{This} program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

\hyperlink{namespace_this}{This} program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR \hyperlink{struct_a}{A} P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301 U\+SA.

\hyperlink{namespace_this}{This} file is part of mbed T\+LS (\href{https://tls.mbed.org}{\tt https\+://tls.\+mbed.\+org}) 

\subsection{宏定义说明}
\mbox{\Hypertarget{ccm_8h_ae7fda1fbbd14f096374da7ccd54f9d3e}\label{ccm_8h_ae7fda1fbbd14f096374da7ccd54f9d3e}} 
\index{ccm.\+h@{ccm.\+h}!M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+C\+C\+M\+\_\+\+A\+U\+T\+H\+\_\+\+F\+A\+I\+L\+ED@{M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+C\+C\+M\+\_\+\+A\+U\+T\+H\+\_\+\+F\+A\+I\+L\+ED}}
\index{M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+C\+C\+M\+\_\+\+A\+U\+T\+H\+\_\+\+F\+A\+I\+L\+ED@{M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+C\+C\+M\+\_\+\+A\+U\+T\+H\+\_\+\+F\+A\+I\+L\+ED}!ccm.\+h@{ccm.\+h}}
\subsubsection{\texorpdfstring{M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+C\+C\+M\+\_\+\+A\+U\+T\+H\+\_\+\+F\+A\+I\+L\+ED}{MBEDTLS\_ERR\_CCM\_AUTH\_FAILED}}
{\footnotesize\ttfamily \#\hyperlink{structdefine}{define} M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+C\+C\+M\+\_\+\+A\+U\+T\+H\+\_\+\+F\+A\+I\+L\+ED~-\/0x000F}

Authenticated decryption failed. \mbox{\Hypertarget{ccm_8h_a6ad00876b856ad8ac9f366fa7e1cf463}\label{ccm_8h_a6ad00876b856ad8ac9f366fa7e1cf463}} 
\index{ccm.\+h@{ccm.\+h}!M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+C\+C\+M\+\_\+\+B\+A\+D\+\_\+\+I\+N\+P\+UT@{M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+C\+C\+M\+\_\+\+B\+A\+D\+\_\+\+I\+N\+P\+UT}}
\index{M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+C\+C\+M\+\_\+\+B\+A\+D\+\_\+\+I\+N\+P\+UT@{M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+C\+C\+M\+\_\+\+B\+A\+D\+\_\+\+I\+N\+P\+UT}!ccm.\+h@{ccm.\+h}}
\subsubsection{\texorpdfstring{M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+C\+C\+M\+\_\+\+B\+A\+D\+\_\+\+I\+N\+P\+UT}{MBEDTLS\_ERR\_CCM\_BAD\_INPUT}}
{\footnotesize\ttfamily \#\hyperlink{structdefine}{define} M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+C\+C\+M\+\_\+\+B\+A\+D\+\_\+\+I\+N\+P\+UT~-\/0x000D}

Bad input parameters to function. 

\subsection{函数说明}
\mbox{\Hypertarget{ccm_8h_a8dc9dfe246064185498f005d8bf22622}\label{ccm_8h_a8dc9dfe246064185498f005d8bf22622}} 
\index{ccm.\+h@{ccm.\+h}!mbedtls\+\_\+ccm\+\_\+auth\+\_\+decrypt@{mbedtls\+\_\+ccm\+\_\+auth\+\_\+decrypt}}
\index{mbedtls\+\_\+ccm\+\_\+auth\+\_\+decrypt@{mbedtls\+\_\+ccm\+\_\+auth\+\_\+decrypt}!ccm.\+h@{ccm.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+ccm\+\_\+auth\+\_\+decrypt()}{mbedtls\_ccm\_auth\_decrypt()}}
{\footnotesize\ttfamily int mbedtls\+\_\+ccm\+\_\+auth\+\_\+decrypt (\begin{DoxyParamCaption}\item[{\hyperlink{structmbedtls__ccm__context}{mbedtls\+\_\+ccm\+\_\+context} $\ast$}]{ctx,  }\item[{size\+\_\+t}]{length,  }\item[{const unsigned char $\ast$}]{iv,  }\item[{size\+\_\+t}]{iv\+\_\+len,  }\item[{const unsigned char $\ast$}]{add,  }\item[{size\+\_\+t}]{add\+\_\+len,  }\item[{const unsigned char $\ast$}]{input,  }\item[{unsigned char $\ast$}]{output,  }\item[{const unsigned char $\ast$}]{tag,  }\item[{size\+\_\+t}]{tag\+\_\+len }\end{DoxyParamCaption})}



C\+CM buffer authenticated decryption 


\begin{DoxyParams}{参数}
{\em ctx} & C\+CM context \\
\hline
{\em length} & length of the input data \\
\hline
{\em iv} & initialization vector \\
\hline
{\em iv\+\_\+len} & length of IV \\
\hline
{\em add} & additional data \\
\hline
{\em add\+\_\+len} & length of additional data \\
\hline
{\em input} & buffer holding the input data \\
\hline
{\em output} & buffer for holding the output data \\
\hline
{\em tag} & buffer holding the tag \\
\hline
{\em tag\+\_\+len} & length of the tag\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{返回}
0 if successful and authenticated, M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+C\+C\+M\+\_\+\+A\+U\+T\+H\+\_\+\+F\+A\+I\+L\+ED if tag does not match 
\end{DoxyReturn}
\mbox{\Hypertarget{ccm_8h_a64de697edfefbff94d7eb0d9a8de926f}\label{ccm_8h_a64de697edfefbff94d7eb0d9a8de926f}} 
\index{ccm.\+h@{ccm.\+h}!mbedtls\+\_\+ccm\+\_\+encrypt\+\_\+and\+\_\+tag@{mbedtls\+\_\+ccm\+\_\+encrypt\+\_\+and\+\_\+tag}}
\index{mbedtls\+\_\+ccm\+\_\+encrypt\+\_\+and\+\_\+tag@{mbedtls\+\_\+ccm\+\_\+encrypt\+\_\+and\+\_\+tag}!ccm.\+h@{ccm.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+ccm\+\_\+encrypt\+\_\+and\+\_\+tag()}{mbedtls\_ccm\_encrypt\_and\_tag()}}
{\footnotesize\ttfamily int mbedtls\+\_\+ccm\+\_\+encrypt\+\_\+and\+\_\+tag (\begin{DoxyParamCaption}\item[{\hyperlink{structmbedtls__ccm__context}{mbedtls\+\_\+ccm\+\_\+context} $\ast$}]{ctx,  }\item[{size\+\_\+t}]{length,  }\item[{const unsigned char $\ast$}]{iv,  }\item[{size\+\_\+t}]{iv\+\_\+len,  }\item[{const unsigned char $\ast$}]{add,  }\item[{size\+\_\+t}]{add\+\_\+len,  }\item[{const unsigned char $\ast$}]{input,  }\item[{unsigned char $\ast$}]{output,  }\item[{unsigned char $\ast$}]{tag,  }\item[{size\+\_\+t}]{tag\+\_\+len }\end{DoxyParamCaption})}



C\+CM buffer encryption 


\begin{DoxyParams}{参数}
{\em ctx} & C\+CM context \\
\hline
{\em length} & length of the input data in bytes \\
\hline
{\em iv} & nonce (initialization vector) \\
\hline
{\em iv\+\_\+len} & length of IV in bytes must be 2, 3, 4, 5, 6, 7 or 8 \\
\hline
{\em add} & additional data \\
\hline
{\em add\+\_\+len} & length of additional data in bytes must be less than 2$^\wedge$16 -\/ 2$^\wedge$8 \\
\hline
{\em input} & buffer holding the input data \\
\hline
{\em output} & buffer for holding the output data must be at least \textquotesingle{}length\textquotesingle{} bytes wide \\
\hline
{\em tag} & buffer for holding the tag \\
\hline
{\em tag\+\_\+len} & length of the tag to generate in bytes must be 4, 6, 8, 10, 14 or 16\\
\hline
\end{DoxyParams}
\begin{DoxyNote}{注解}
The tag is written to a separate buffer. To get the tag concatenated with the output as in the C\+CM spec, use tag = output + length and make sure the output buffer is at least length + tag\+\_\+len wide.
\end{DoxyNote}
\begin{DoxyReturn}{返回}
0 if successful 
\end{DoxyReturn}
\mbox{\Hypertarget{ccm_8h_a2bd8130a83c6633a4dfd61b181cdabac}\label{ccm_8h_a2bd8130a83c6633a4dfd61b181cdabac}} 
\index{ccm.\+h@{ccm.\+h}!mbedtls\+\_\+ccm\+\_\+free@{mbedtls\+\_\+ccm\+\_\+free}}
\index{mbedtls\+\_\+ccm\+\_\+free@{mbedtls\+\_\+ccm\+\_\+free}!ccm.\+h@{ccm.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+ccm\+\_\+free()}{mbedtls\_ccm\_free()}}
{\footnotesize\ttfamily \hyperlink{interfacevoid}{void} mbedtls\+\_\+ccm\+\_\+free (\begin{DoxyParamCaption}\item[{\hyperlink{structmbedtls__ccm__context}{mbedtls\+\_\+ccm\+\_\+context} $\ast$}]{ctx }\end{DoxyParamCaption})}



Free a C\+CM context and underlying cipher sub-\/context 


\begin{DoxyParams}{参数}
{\em ctx} & C\+CM context to free \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{ccm_8h_abaeb0629dfac72016fda58a4f7870040}\label{ccm_8h_abaeb0629dfac72016fda58a4f7870040}} 
\index{ccm.\+h@{ccm.\+h}!mbedtls\+\_\+ccm\+\_\+init@{mbedtls\+\_\+ccm\+\_\+init}}
\index{mbedtls\+\_\+ccm\+\_\+init@{mbedtls\+\_\+ccm\+\_\+init}!ccm.\+h@{ccm.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+ccm\+\_\+init()}{mbedtls\_ccm\_init()}}
{\footnotesize\ttfamily \hyperlink{interfacevoid}{void} mbedtls\+\_\+ccm\+\_\+init (\begin{DoxyParamCaption}\item[{\hyperlink{structmbedtls__ccm__context}{mbedtls\+\_\+ccm\+\_\+context} $\ast$}]{ctx }\end{DoxyParamCaption})}



Initialize C\+CM context (just makes references valid) Makes the context ready for \hyperlink{ccm_8h_a464d8e724738b4bbd5b415ca0580f1b1}{mbedtls\+\_\+ccm\+\_\+setkey()} or \hyperlink{ccm_8h_a2bd8130a83c6633a4dfd61b181cdabac}{mbedtls\+\_\+ccm\+\_\+free()}. 


\begin{DoxyParams}{参数}
{\em ctx} & C\+CM context to initialize \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{ccm_8h_a464d8e724738b4bbd5b415ca0580f1b1}\label{ccm_8h_a464d8e724738b4bbd5b415ca0580f1b1}} 
\index{ccm.\+h@{ccm.\+h}!mbedtls\+\_\+ccm\+\_\+setkey@{mbedtls\+\_\+ccm\+\_\+setkey}}
\index{mbedtls\+\_\+ccm\+\_\+setkey@{mbedtls\+\_\+ccm\+\_\+setkey}!ccm.\+h@{ccm.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+ccm\+\_\+setkey()}{mbedtls\_ccm\_setkey()}}
{\footnotesize\ttfamily int mbedtls\+\_\+ccm\+\_\+setkey (\begin{DoxyParamCaption}\item[{\hyperlink{structmbedtls__ccm__context}{mbedtls\+\_\+ccm\+\_\+context} $\ast$}]{ctx,  }\item[{mbedtls\+\_\+cipher\+\_\+id\+\_\+t}]{cipher,  }\item[{const unsigned char $\ast$}]{key,  }\item[{unsigned int}]{keybits }\end{DoxyParamCaption})}



C\+CM initialization (encryption and decryption) 


\begin{DoxyParams}{参数}
{\em ctx} & C\+CM context to be initialized \\
\hline
{\em cipher} & cipher to use (a 128-\/bit block cipher) \\
\hline
{\em key} & encryption key \\
\hline
{\em keybits} & key size in bits (must be acceptable by the cipher)\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{返回}
0 if successful, or a cipher specific error code 
\end{DoxyReturn}
