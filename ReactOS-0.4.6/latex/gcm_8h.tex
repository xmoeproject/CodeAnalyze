\hypertarget{gcm_8h}{}\section{E\+:/\+React\+O\+S-\/0.4.6/sdk/include/reactos/libs/mbedtls/gcm.h 文件参考}
\label{gcm_8h}\index{E\+:/\+React\+O\+S-\/0.\+4.\+6/sdk/include/reactos/libs/mbedtls/gcm.\+h@{E\+:/\+React\+O\+S-\/0.\+4.\+6/sdk/include/reactos/libs/mbedtls/gcm.\+h}}


Galois/\+Counter mode for 128-\/bit block ciphers  


{\ttfamily \#include \char`\"{}cipher.\+h\char`\"{}}\newline
{\ttfamily \#include $<$stdint.\+h$>$}\newline
\subsection*{类}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structmbedtls__gcm__context}{mbedtls\+\_\+gcm\+\_\+context}
\begin{DoxyCompactList}\small\item\em G\+CM context structure \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{宏定义}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{gcm_8h_a023326dceb6d25c6d0c8a383f8748e86}\label{gcm_8h_a023326dceb6d25c6d0c8a383f8748e86}} 
\#\hyperlink{structdefine}{define} {\bfseries M\+B\+E\+D\+T\+L\+S\+\_\+\+G\+C\+M\+\_\+\+E\+N\+C\+R\+Y\+PT}~1
\item 
\mbox{\Hypertarget{gcm_8h_a792b42066d6fac0a85d547f5c9c5636a}\label{gcm_8h_a792b42066d6fac0a85d547f5c9c5636a}} 
\#\hyperlink{structdefine}{define} {\bfseries M\+B\+E\+D\+T\+L\+S\+\_\+\+G\+C\+M\+\_\+\+D\+E\+C\+R\+Y\+PT}~0
\item 
\#\hyperlink{structdefine}{define} \hyperlink{gcm_8h_a4ed179bbaac5f312fb1235d33db3f6c4}{M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+G\+C\+M\+\_\+\+A\+U\+T\+H\+\_\+\+F\+A\+I\+L\+ED}~-\/0x0012
\item 
\#\hyperlink{structdefine}{define} \hyperlink{gcm_8h_a77153ba10a2c9d428bdb1fb02076429e}{M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+G\+C\+M\+\_\+\+B\+A\+D\+\_\+\+I\+N\+P\+UT}~-\/0x0014
\end{DoxyCompactItemize}
\subsection*{函数}
\begin{DoxyCompactItemize}
\item 
\hyperlink{interfacevoid}{void} \hyperlink{gcm_8h_ac3f60a663c6b01ef6d977ac06aac57df}{mbedtls\+\_\+gcm\+\_\+init} (\hyperlink{structmbedtls__gcm__context}{mbedtls\+\_\+gcm\+\_\+context} $\ast$ctx)
\begin{DoxyCompactList}\small\item\em Initialize G\+CM context (just makes references valid) Makes the context ready for \hyperlink{gcm_8h_ae87d2c58882a11976fdc6a30f6f0ae6f}{mbedtls\+\_\+gcm\+\_\+setkey()} or \hyperlink{gcm_8h_af09c2638d0ff09880517231df34d346f}{mbedtls\+\_\+gcm\+\_\+free()}. \end{DoxyCompactList}\item 
int \hyperlink{gcm_8h_ae87d2c58882a11976fdc6a30f6f0ae6f}{mbedtls\+\_\+gcm\+\_\+setkey} (\hyperlink{structmbedtls__gcm__context}{mbedtls\+\_\+gcm\+\_\+context} $\ast$ctx, mbedtls\+\_\+cipher\+\_\+id\+\_\+t cipher, const unsigned char $\ast$\hyperlink{structkey}{key}, unsigned int keybits)
\begin{DoxyCompactList}\small\item\em G\+CM initialization (encryption) \end{DoxyCompactList}\item 
int \hyperlink{gcm_8h_a3ad456f90f60211f72005dc815b808b5}{mbedtls\+\_\+gcm\+\_\+crypt\+\_\+and\+\_\+tag} (\hyperlink{structmbedtls__gcm__context}{mbedtls\+\_\+gcm\+\_\+context} $\ast$ctx, int \hyperlink{interfacevoid}{mode}, size\+\_\+t length, const unsigned char $\ast$iv, size\+\_\+t iv\+\_\+len, const unsigned char $\ast$add, size\+\_\+t add\+\_\+len, const unsigned char $\ast$input, unsigned char $\ast$output, size\+\_\+t tag\+\_\+len, unsigned char $\ast$\hyperlink{structtag}{tag})
\begin{DoxyCompactList}\small\item\em G\+CM buffer encryption/decryption using a block cipher \end{DoxyCompactList}\item 
int \hyperlink{gcm_8h_af264b64b26c4720188b530cfccddb4ef}{mbedtls\+\_\+gcm\+\_\+auth\+\_\+decrypt} (\hyperlink{structmbedtls__gcm__context}{mbedtls\+\_\+gcm\+\_\+context} $\ast$ctx, size\+\_\+t length, const unsigned char $\ast$iv, size\+\_\+t iv\+\_\+len, const unsigned char $\ast$add, size\+\_\+t add\+\_\+len, const unsigned char $\ast$\hyperlink{structtag}{tag}, size\+\_\+t tag\+\_\+len, const unsigned char $\ast$input, unsigned char $\ast$output)
\begin{DoxyCompactList}\small\item\em G\+CM buffer authenticated decryption using a block cipher \end{DoxyCompactList}\item 
int \hyperlink{gcm_8h_a1fc3a11f761e37d515e013d8c8f8975f}{mbedtls\+\_\+gcm\+\_\+starts} (\hyperlink{structmbedtls__gcm__context}{mbedtls\+\_\+gcm\+\_\+context} $\ast$ctx, int \hyperlink{interfacevoid}{mode}, const unsigned char $\ast$iv, size\+\_\+t iv\+\_\+len, const unsigned char $\ast$add, size\+\_\+t add\+\_\+len)
\begin{DoxyCompactList}\small\item\em Generic G\+CM stream start function \end{DoxyCompactList}\item 
int \hyperlink{gcm_8h_a922addfa5c93fa08b6e9da134d5d8f2d}{mbedtls\+\_\+gcm\+\_\+update} (\hyperlink{structmbedtls__gcm__context}{mbedtls\+\_\+gcm\+\_\+context} $\ast$ctx, size\+\_\+t length, const unsigned char $\ast$input, unsigned char $\ast$output)
\begin{DoxyCompactList}\small\item\em Generic G\+CM update function. Encrypts/decrypts using the given G\+CM context. Expects input to be a multiple of 16 bytes! Only the last call before \hyperlink{gcm_8h_a3b6fb653c3085e063c9558eb4a05fc4d}{mbedtls\+\_\+gcm\+\_\+finish()} can be less than 16 bytes! \end{DoxyCompactList}\item 
int \hyperlink{gcm_8h_a3b6fb653c3085e063c9558eb4a05fc4d}{mbedtls\+\_\+gcm\+\_\+finish} (\hyperlink{structmbedtls__gcm__context}{mbedtls\+\_\+gcm\+\_\+context} $\ast$ctx, unsigned char $\ast$\hyperlink{structtag}{tag}, size\+\_\+t tag\+\_\+len)
\begin{DoxyCompactList}\small\item\em Generic G\+CM finalisation function. Wraps up the G\+CM stream and generates the tag. The tag can have a maximum length of 16 bytes. \end{DoxyCompactList}\item 
\hyperlink{interfacevoid}{void} \hyperlink{gcm_8h_af09c2638d0ff09880517231df34d346f}{mbedtls\+\_\+gcm\+\_\+free} (\hyperlink{structmbedtls__gcm__context}{mbedtls\+\_\+gcm\+\_\+context} $\ast$ctx)
\begin{DoxyCompactList}\small\item\em Free a G\+CM context and underlying cipher sub-\/context \end{DoxyCompactList}\item 
int \hyperlink{gcm_8h_af08f4690bdc542d366494d13422fa7a3}{mbedtls\+\_\+gcm\+\_\+self\+\_\+test} (int verbose)
\begin{DoxyCompactList}\small\item\em Checkup routine \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{详细描述}
Galois/\+Counter mode for 128-\/bit block ciphers 

Copyright (\hyperlink{struct_c}{C}) 2006-\/2015, A\+RM Limited, All Rights Reserved S\+P\+D\+X-\/\+License-\/\+Identifier\+: G\+P\+L-\/2.\+0

\hyperlink{namespace_this}{This} program is free software; you can redistribute it and/or modify it under the terms of the G\+NU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.

\hyperlink{namespace_this}{This} program is distributed in the hope that it will be useful, but W\+I\+T\+H\+O\+UT A\+NY W\+A\+R\+R\+A\+N\+TY; without even the implied warranty of M\+E\+R\+C\+H\+A\+N\+T\+A\+B\+I\+L\+I\+TY or F\+I\+T\+N\+E\+SS F\+OR \hyperlink{struct_a}{A} P\+A\+R\+T\+I\+C\+U\+L\+AR P\+U\+R\+P\+O\+SE. See the G\+NU General Public License for more details.

You should have received a copy of the G\+NU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-\/1301 U\+SA.

\hyperlink{namespace_this}{This} file is part of mbed T\+LS (\href{https://tls.mbed.org}{\tt https\+://tls.\+mbed.\+org}) 

\subsection{宏定义说明}
\mbox{\Hypertarget{gcm_8h_a4ed179bbaac5f312fb1235d33db3f6c4}\label{gcm_8h_a4ed179bbaac5f312fb1235d33db3f6c4}} 
\index{gcm.\+h@{gcm.\+h}!M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+G\+C\+M\+\_\+\+A\+U\+T\+H\+\_\+\+F\+A\+I\+L\+ED@{M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+G\+C\+M\+\_\+\+A\+U\+T\+H\+\_\+\+F\+A\+I\+L\+ED}}
\index{M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+G\+C\+M\+\_\+\+A\+U\+T\+H\+\_\+\+F\+A\+I\+L\+ED@{M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+G\+C\+M\+\_\+\+A\+U\+T\+H\+\_\+\+F\+A\+I\+L\+ED}!gcm.\+h@{gcm.\+h}}
\subsubsection{\texorpdfstring{M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+G\+C\+M\+\_\+\+A\+U\+T\+H\+\_\+\+F\+A\+I\+L\+ED}{MBEDTLS\_ERR\_GCM\_AUTH\_FAILED}}
{\footnotesize\ttfamily \#\hyperlink{structdefine}{define} M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+G\+C\+M\+\_\+\+A\+U\+T\+H\+\_\+\+F\+A\+I\+L\+ED~-\/0x0012}

Authenticated decryption failed. \mbox{\Hypertarget{gcm_8h_a77153ba10a2c9d428bdb1fb02076429e}\label{gcm_8h_a77153ba10a2c9d428bdb1fb02076429e}} 
\index{gcm.\+h@{gcm.\+h}!M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+G\+C\+M\+\_\+\+B\+A\+D\+\_\+\+I\+N\+P\+UT@{M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+G\+C\+M\+\_\+\+B\+A\+D\+\_\+\+I\+N\+P\+UT}}
\index{M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+G\+C\+M\+\_\+\+B\+A\+D\+\_\+\+I\+N\+P\+UT@{M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+G\+C\+M\+\_\+\+B\+A\+D\+\_\+\+I\+N\+P\+UT}!gcm.\+h@{gcm.\+h}}
\subsubsection{\texorpdfstring{M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+G\+C\+M\+\_\+\+B\+A\+D\+\_\+\+I\+N\+P\+UT}{MBEDTLS\_ERR\_GCM\_BAD\_INPUT}}
{\footnotesize\ttfamily \#\hyperlink{structdefine}{define} M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+G\+C\+M\+\_\+\+B\+A\+D\+\_\+\+I\+N\+P\+UT~-\/0x0014}

Bad input parameters to function. 

\subsection{函数说明}
\mbox{\Hypertarget{gcm_8h_af264b64b26c4720188b530cfccddb4ef}\label{gcm_8h_af264b64b26c4720188b530cfccddb4ef}} 
\index{gcm.\+h@{gcm.\+h}!mbedtls\+\_\+gcm\+\_\+auth\+\_\+decrypt@{mbedtls\+\_\+gcm\+\_\+auth\+\_\+decrypt}}
\index{mbedtls\+\_\+gcm\+\_\+auth\+\_\+decrypt@{mbedtls\+\_\+gcm\+\_\+auth\+\_\+decrypt}!gcm.\+h@{gcm.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+gcm\+\_\+auth\+\_\+decrypt()}{mbedtls\_gcm\_auth\_decrypt()}}
{\footnotesize\ttfamily int mbedtls\+\_\+gcm\+\_\+auth\+\_\+decrypt (\begin{DoxyParamCaption}\item[{\hyperlink{structmbedtls__gcm__context}{mbedtls\+\_\+gcm\+\_\+context} $\ast$}]{ctx,  }\item[{size\+\_\+t}]{length,  }\item[{const unsigned char $\ast$}]{iv,  }\item[{size\+\_\+t}]{iv\+\_\+len,  }\item[{const unsigned char $\ast$}]{add,  }\item[{size\+\_\+t}]{add\+\_\+len,  }\item[{const unsigned char $\ast$}]{tag,  }\item[{size\+\_\+t}]{tag\+\_\+len,  }\item[{const unsigned char $\ast$}]{input,  }\item[{unsigned char $\ast$}]{output }\end{DoxyParamCaption})}



G\+CM buffer authenticated decryption using a block cipher 

\begin{DoxyNote}{注解}
On decryption, the output buffer cannot be the same as input buffer. If buffers overlap, the output buffer must trail at least 8 bytes behind the input buffer.
\end{DoxyNote}

\begin{DoxyParams}{参数}
{\em ctx} & G\+CM context \\
\hline
{\em length} & length of the input data \\
\hline
{\em iv} & initialization vector \\
\hline
{\em iv\+\_\+len} & length of IV \\
\hline
{\em add} & additional data \\
\hline
{\em add\+\_\+len} & length of additional data \\
\hline
{\em tag} & buffer holding the tag \\
\hline
{\em tag\+\_\+len} & length of the tag \\
\hline
{\em input} & buffer holding the input data \\
\hline
{\em output} & buffer for holding the output data\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{返回}
0 if successful and authenticated, M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+G\+C\+M\+\_\+\+A\+U\+T\+H\+\_\+\+F\+A\+I\+L\+ED if tag does not match 
\end{DoxyReturn}
\mbox{\Hypertarget{gcm_8h_a3ad456f90f60211f72005dc815b808b5}\label{gcm_8h_a3ad456f90f60211f72005dc815b808b5}} 
\index{gcm.\+h@{gcm.\+h}!mbedtls\+\_\+gcm\+\_\+crypt\+\_\+and\+\_\+tag@{mbedtls\+\_\+gcm\+\_\+crypt\+\_\+and\+\_\+tag}}
\index{mbedtls\+\_\+gcm\+\_\+crypt\+\_\+and\+\_\+tag@{mbedtls\+\_\+gcm\+\_\+crypt\+\_\+and\+\_\+tag}!gcm.\+h@{gcm.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+gcm\+\_\+crypt\+\_\+and\+\_\+tag()}{mbedtls\_gcm\_crypt\_and\_tag()}}
{\footnotesize\ttfamily int mbedtls\+\_\+gcm\+\_\+crypt\+\_\+and\+\_\+tag (\begin{DoxyParamCaption}\item[{\hyperlink{structmbedtls__gcm__context}{mbedtls\+\_\+gcm\+\_\+context} $\ast$}]{ctx,  }\item[{int}]{mode,  }\item[{size\+\_\+t}]{length,  }\item[{const unsigned char $\ast$}]{iv,  }\item[{size\+\_\+t}]{iv\+\_\+len,  }\item[{const unsigned char $\ast$}]{add,  }\item[{size\+\_\+t}]{add\+\_\+len,  }\item[{const unsigned char $\ast$}]{input,  }\item[{unsigned char $\ast$}]{output,  }\item[{size\+\_\+t}]{tag\+\_\+len,  }\item[{unsigned char $\ast$}]{tag }\end{DoxyParamCaption})}



G\+CM buffer encryption/decryption using a block cipher 

\begin{DoxyNote}{注解}
On encryption, the output buffer can be the same as the input buffer. On decryption, the output buffer cannot be the same as input buffer. If buffers overlap, the output buffer must trail at least 8 bytes behind the input buffer.
\end{DoxyNote}

\begin{DoxyParams}{参数}
{\em ctx} & G\+CM context \\
\hline
{\em mode} & M\+B\+E\+D\+T\+L\+S\+\_\+\+G\+C\+M\+\_\+\+E\+N\+C\+R\+Y\+PT or M\+B\+E\+D\+T\+L\+S\+\_\+\+G\+C\+M\+\_\+\+D\+E\+C\+R\+Y\+PT \\
\hline
{\em length} & length of the input data \\
\hline
{\em iv} & initialization vector \\
\hline
{\em iv\+\_\+len} & length of IV \\
\hline
{\em add} & additional data \\
\hline
{\em add\+\_\+len} & length of additional data \\
\hline
{\em input} & buffer holding the input data \\
\hline
{\em output} & buffer for holding the output data \\
\hline
{\em tag\+\_\+len} & length of the tag to generate \\
\hline
{\em tag} & buffer for holding the tag\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{返回}
0 if successful 
\end{DoxyReturn}
\mbox{\Hypertarget{gcm_8h_a3b6fb653c3085e063c9558eb4a05fc4d}\label{gcm_8h_a3b6fb653c3085e063c9558eb4a05fc4d}} 
\index{gcm.\+h@{gcm.\+h}!mbedtls\+\_\+gcm\+\_\+finish@{mbedtls\+\_\+gcm\+\_\+finish}}
\index{mbedtls\+\_\+gcm\+\_\+finish@{mbedtls\+\_\+gcm\+\_\+finish}!gcm.\+h@{gcm.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+gcm\+\_\+finish()}{mbedtls\_gcm\_finish()}}
{\footnotesize\ttfamily int mbedtls\+\_\+gcm\+\_\+finish (\begin{DoxyParamCaption}\item[{\hyperlink{structmbedtls__gcm__context}{mbedtls\+\_\+gcm\+\_\+context} $\ast$}]{ctx,  }\item[{unsigned char $\ast$}]{tag,  }\item[{size\+\_\+t}]{tag\+\_\+len }\end{DoxyParamCaption})}



Generic G\+CM finalisation function. Wraps up the G\+CM stream and generates the tag. The tag can have a maximum length of 16 bytes. 


\begin{DoxyParams}{参数}
{\em ctx} & G\+CM context \\
\hline
{\em tag} & buffer for holding the tag \\
\hline
{\em tag\+\_\+len} & length of the tag to generate (must be at least 4)\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{返回}
0 if successful or M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+G\+C\+M\+\_\+\+B\+A\+D\+\_\+\+I\+N\+P\+UT 
\end{DoxyReturn}
\mbox{\Hypertarget{gcm_8h_af09c2638d0ff09880517231df34d346f}\label{gcm_8h_af09c2638d0ff09880517231df34d346f}} 
\index{gcm.\+h@{gcm.\+h}!mbedtls\+\_\+gcm\+\_\+free@{mbedtls\+\_\+gcm\+\_\+free}}
\index{mbedtls\+\_\+gcm\+\_\+free@{mbedtls\+\_\+gcm\+\_\+free}!gcm.\+h@{gcm.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+gcm\+\_\+free()}{mbedtls\_gcm\_free()}}
{\footnotesize\ttfamily \hyperlink{interfacevoid}{void} mbedtls\+\_\+gcm\+\_\+free (\begin{DoxyParamCaption}\item[{\hyperlink{structmbedtls__gcm__context}{mbedtls\+\_\+gcm\+\_\+context} $\ast$}]{ctx }\end{DoxyParamCaption})}



Free a G\+CM context and underlying cipher sub-\/context 


\begin{DoxyParams}{参数}
{\em ctx} & G\+CM context to free \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{gcm_8h_ac3f60a663c6b01ef6d977ac06aac57df}\label{gcm_8h_ac3f60a663c6b01ef6d977ac06aac57df}} 
\index{gcm.\+h@{gcm.\+h}!mbedtls\+\_\+gcm\+\_\+init@{mbedtls\+\_\+gcm\+\_\+init}}
\index{mbedtls\+\_\+gcm\+\_\+init@{mbedtls\+\_\+gcm\+\_\+init}!gcm.\+h@{gcm.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+gcm\+\_\+init()}{mbedtls\_gcm\_init()}}
{\footnotesize\ttfamily \hyperlink{interfacevoid}{void} mbedtls\+\_\+gcm\+\_\+init (\begin{DoxyParamCaption}\item[{\hyperlink{structmbedtls__gcm__context}{mbedtls\+\_\+gcm\+\_\+context} $\ast$}]{ctx }\end{DoxyParamCaption})}



Initialize G\+CM context (just makes references valid) Makes the context ready for \hyperlink{gcm_8h_ae87d2c58882a11976fdc6a30f6f0ae6f}{mbedtls\+\_\+gcm\+\_\+setkey()} or \hyperlink{gcm_8h_af09c2638d0ff09880517231df34d346f}{mbedtls\+\_\+gcm\+\_\+free()}. 


\begin{DoxyParams}{参数}
{\em ctx} & G\+CM context to initialize \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{gcm_8h_af08f4690bdc542d366494d13422fa7a3}\label{gcm_8h_af08f4690bdc542d366494d13422fa7a3}} 
\index{gcm.\+h@{gcm.\+h}!mbedtls\+\_\+gcm\+\_\+self\+\_\+test@{mbedtls\+\_\+gcm\+\_\+self\+\_\+test}}
\index{mbedtls\+\_\+gcm\+\_\+self\+\_\+test@{mbedtls\+\_\+gcm\+\_\+self\+\_\+test}!gcm.\+h@{gcm.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+gcm\+\_\+self\+\_\+test()}{mbedtls\_gcm\_self\_test()}}
{\footnotesize\ttfamily int mbedtls\+\_\+gcm\+\_\+self\+\_\+test (\begin{DoxyParamCaption}\item[{int}]{verbose }\end{DoxyParamCaption})}



Checkup routine 

\begin{DoxyReturn}{返回}
0 if successful, or 1 if the test failed 
\end{DoxyReturn}
\mbox{\Hypertarget{gcm_8h_ae87d2c58882a11976fdc6a30f6f0ae6f}\label{gcm_8h_ae87d2c58882a11976fdc6a30f6f0ae6f}} 
\index{gcm.\+h@{gcm.\+h}!mbedtls\+\_\+gcm\+\_\+setkey@{mbedtls\+\_\+gcm\+\_\+setkey}}
\index{mbedtls\+\_\+gcm\+\_\+setkey@{mbedtls\+\_\+gcm\+\_\+setkey}!gcm.\+h@{gcm.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+gcm\+\_\+setkey()}{mbedtls\_gcm\_setkey()}}
{\footnotesize\ttfamily int mbedtls\+\_\+gcm\+\_\+setkey (\begin{DoxyParamCaption}\item[{\hyperlink{structmbedtls__gcm__context}{mbedtls\+\_\+gcm\+\_\+context} $\ast$}]{ctx,  }\item[{mbedtls\+\_\+cipher\+\_\+id\+\_\+t}]{cipher,  }\item[{const unsigned char $\ast$}]{key,  }\item[{unsigned int}]{keybits }\end{DoxyParamCaption})}



G\+CM initialization (encryption) 


\begin{DoxyParams}{参数}
{\em ctx} & G\+CM context to be initialized \\
\hline
{\em cipher} & cipher to use (a 128-\/bit block cipher) \\
\hline
{\em key} & encryption key \\
\hline
{\em keybits} & must be 128, 192 or 256\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{返回}
0 if successful, or a cipher specific error code 
\end{DoxyReturn}
\mbox{\Hypertarget{gcm_8h_a1fc3a11f761e37d515e013d8c8f8975f}\label{gcm_8h_a1fc3a11f761e37d515e013d8c8f8975f}} 
\index{gcm.\+h@{gcm.\+h}!mbedtls\+\_\+gcm\+\_\+starts@{mbedtls\+\_\+gcm\+\_\+starts}}
\index{mbedtls\+\_\+gcm\+\_\+starts@{mbedtls\+\_\+gcm\+\_\+starts}!gcm.\+h@{gcm.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+gcm\+\_\+starts()}{mbedtls\_gcm\_starts()}}
{\footnotesize\ttfamily int mbedtls\+\_\+gcm\+\_\+starts (\begin{DoxyParamCaption}\item[{\hyperlink{structmbedtls__gcm__context}{mbedtls\+\_\+gcm\+\_\+context} $\ast$}]{ctx,  }\item[{int}]{mode,  }\item[{const unsigned char $\ast$}]{iv,  }\item[{size\+\_\+t}]{iv\+\_\+len,  }\item[{const unsigned char $\ast$}]{add,  }\item[{size\+\_\+t}]{add\+\_\+len }\end{DoxyParamCaption})}



Generic G\+CM stream start function 


\begin{DoxyParams}{参数}
{\em ctx} & G\+CM context \\
\hline
{\em mode} & M\+B\+E\+D\+T\+L\+S\+\_\+\+G\+C\+M\+\_\+\+E\+N\+C\+R\+Y\+PT or M\+B\+E\+D\+T\+L\+S\+\_\+\+G\+C\+M\+\_\+\+D\+E\+C\+R\+Y\+PT \\
\hline
{\em iv} & initialization vector \\
\hline
{\em iv\+\_\+len} & length of IV \\
\hline
{\em add} & additional data (or N\+U\+LL if length is 0) \\
\hline
{\em add\+\_\+len} & length of additional data\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{返回}
0 if successful 
\end{DoxyReturn}
\mbox{\Hypertarget{gcm_8h_a922addfa5c93fa08b6e9da134d5d8f2d}\label{gcm_8h_a922addfa5c93fa08b6e9da134d5d8f2d}} 
\index{gcm.\+h@{gcm.\+h}!mbedtls\+\_\+gcm\+\_\+update@{mbedtls\+\_\+gcm\+\_\+update}}
\index{mbedtls\+\_\+gcm\+\_\+update@{mbedtls\+\_\+gcm\+\_\+update}!gcm.\+h@{gcm.\+h}}
\subsubsection{\texorpdfstring{mbedtls\+\_\+gcm\+\_\+update()}{mbedtls\_gcm\_update()}}
{\footnotesize\ttfamily int mbedtls\+\_\+gcm\+\_\+update (\begin{DoxyParamCaption}\item[{\hyperlink{structmbedtls__gcm__context}{mbedtls\+\_\+gcm\+\_\+context} $\ast$}]{ctx,  }\item[{size\+\_\+t}]{length,  }\item[{const unsigned char $\ast$}]{input,  }\item[{unsigned char $\ast$}]{output }\end{DoxyParamCaption})}



Generic G\+CM update function. Encrypts/decrypts using the given G\+CM context. Expects input to be a multiple of 16 bytes! Only the last call before \hyperlink{gcm_8h_a3b6fb653c3085e063c9558eb4a05fc4d}{mbedtls\+\_\+gcm\+\_\+finish()} can be less than 16 bytes! 

\begin{DoxyNote}{注解}
On decryption, the output buffer cannot be the same as input buffer. If buffers overlap, the output buffer must trail at least 8 bytes behind the input buffer.
\end{DoxyNote}

\begin{DoxyParams}{参数}
{\em ctx} & G\+CM context \\
\hline
{\em length} & length of the input data \\
\hline
{\em input} & buffer holding the input data \\
\hline
{\em output} & buffer for holding the output data\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{返回}
0 if successful or M\+B\+E\+D\+T\+L\+S\+\_\+\+E\+R\+R\+\_\+\+G\+C\+M\+\_\+\+B\+A\+D\+\_\+\+I\+N\+P\+UT 
\end{DoxyReturn}
